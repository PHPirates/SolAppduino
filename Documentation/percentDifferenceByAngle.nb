(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17392,        396]
NotebookOptionsPosition[     16994,        378]
NotebookOutlinePosition[     17335,        393]
CellTagsIndexPosition[     17292,        390]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"directPower", "  ", ":=", " ", 
   RowBox[{"Function", "[", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"param", ":", " ", 
       RowBox[{"hour", " ", "of", " ", "day", "*", "100"}]}], ",", " ", 
      RowBox[{"solar", " ", "panel", " ", "angle"}], ",", " ", 
      RowBox[{
       RowBox[{"date", ".", " ", "returns"}], " ", 
       RowBox[{"W", "/", 
        SuperscriptBox["m", "2"]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Theta]", "z"], "=", "#1"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"solar", " ", "zenith", " ", 
       RowBox[{"(", "misalignment", ")"}], " ", "in", " ", "radians"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n", "=", " ", 
      RowBox[{"QuantityMagnitude", "[", 
       RowBox[{"Quantity", "[", " ", 
        RowBox[{
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{"2016", ",", "12", ",", "25"}], "}"}], "]"}], " ", "-", 
         " ", 
         RowBox[{"DateObject", "[", 
          RowBox[{"{", 
           RowBox[{"2016", ",", "1", ",", "1"}], "}"}], "]"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["I", "0"], "=", " ", 
      RowBox[{"1367", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"0.034", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"360", "*", 
            RowBox[{"n", "/", "365.25"}]}], "]"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["a", "0"], " ", "=", " ", 
      RowBox[{"0.4237", " ", "-", " ", 
       RowBox[{"0.00821", " ", "36"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["a", "1"], " ", "=", " ", 
      RowBox[{"0.5055", " ", "+", " ", 
       RowBox[{"0.00595", " ", 
        RowBox[{"6.5", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"0.2711", " ", "+", " ", 
       RowBox[{"0.01858", " ", 
        RowBox[{"2.5", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SubscriptBox["\[Theta]", "z"], "]"}], "<", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["I", "direct"], "=", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["I", "direct"], " ", "=", " ", 
        RowBox[{
         SubscriptBox["I", "0"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["a", "0"], " ", "+", " ", 
           RowBox[{
            SubscriptBox["a", "1"], " ", 
            RowBox[{"E", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "k"}], "/", 
               RowBox[{"Cos", "[", 
                SubscriptBox["\[Theta]", "z"], "]"}]}], ")"}]}]}]}], 
          ")"}]}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "the", " ", "sun", " ", "is", " ", "more", " ", "than", 
         " ", "90", " ", "degrees", " ", "off"}], ",", " ", 
        RowBox[{
        "the", " ", "formula", " ", "is", " ", "not", " ", "correct"}], ",", 
        " ", 
        RowBox[{
        "and", " ", "we", " ", "set", " ", "the", " ", "value", " ", "to", 
         " ", "be", " ", "0"}]}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"directPowerPercent", " ", ":=", " ", 
   RowBox[{"Function", "[", "\[IndentingNewLine]", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"directPower", "[", "#1", "]"}], "/", "860"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"DiscretePlot", "[", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{"Cos", "[", 
       RowBox[{"x", "*", 
        RowBox[{"Pi", "/", "180"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "90", ",", "2"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"DiscretePlot", "[", 
     RowBox[{
      RowBox[{"directPowerPercent", "[", 
       RowBox[{"x", "*", 
        RowBox[{"Pi", "/", "180"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "90", ",", "2"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"Cos", "[", 
        RowBox[{"x", "*", 
         RowBox[{"Pi", "/", "180"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "90", ",", "2"}], "}"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6794875868947372`*^9, 3.6794877085026608`*^9}, {
  3.6794877403075113`*^9, 3.6794877572052937`*^9}, {3.679487827144014*^9, 
  3.679487834847045*^9}, {3.6794879070088825`*^9, 3.6794879217979956`*^9}, {
  3.6794880472951264`*^9, 3.67948808724149*^9}, {3.6794881333132277`*^9, 
  3.679488136255541*^9}, {3.6794882465675135`*^9, 3.679488276612565*^9}, {
  3.6794883350070376`*^9, 3.6794883753906384`*^9}, {3.679488416390915*^9, 
  3.679488417242583*^9}, {3.6795495081595235`*^9, 3.679549535482848*^9}, {
  3.6795496206849594`*^9, 3.679549641890972*^9}, {3.6795496926236076`*^9, 
  3.6795496942818055`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(\\*FractionBox[\\\"1\\\
\", \\\"0\\\"]\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.679488342700841*^9, 3.679488418342704*^9, {3.679549519285492*^9, 
   3.679549537531451*^9}, 3.6795496351167207`*^9, 3.679549696043124*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \
\[NoBreak]\\!\\(\\*SuperscriptBox[\\\"\[ExponentialE]\\\", \
\\\"ComplexInfinity\\\"]\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.679488342700841*^9, 3.679488418342704*^9, {3.679549519285492*^9, 
   3.679549537531451*^9}, 3.6795496351167207`*^9, 3.679549696199499*^9}],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.2], 
       LineBox[{{{0., -0.0066612727435566566`}, {0., 0}}, {{
          2., -0.006471115043351405}, {2., 0}}, {{
          4., -0.005899751332841152}, {4., 0}}, {{
          6., -0.004944500082430414}, {6., 0}}, {{
          8., -0.003600859556985636}, {8., 0}}, {{
          10., -0.0018624583805335604`}, {10., 0}}},
        VertexColors->None]}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.2], 
       LineBox[{{{12., 0.00027901500543137114`}, {12., 0}}, {{14., 
          0.0028339053675219272`}, {14., 0}}, {{16., 0.005814708027296889}, {
          16., 0}}, {{18., 0.00923621287947951}, {18., 0}}, {{20., 
          0.013115678012445287`}, {20., 0}}, {{22., 0.017473036528132813`}, {
          22., 0}}, {{24., 0.02233114093026556}, {24., 0}}, {{26., 
          0.027716050350027888`}, {26., 0}}, {{28., 0.03365736693328214}, {
          28., 0}}, {{30., 0.040188628952462446`}, {30., 0}}, {{32., 
          0.047347769661221784`}, {32., 0}}, {{34., 0.05517765261322505}, {
          34., 0}}, {{36., 0.06372669614741089}, {36., 0}}, {{38., 
          0.0730496020190543}, {38., 0}}, {{40., 0.08320820572285836}, {
          40., 0}}, {{42., 0.09427246885494955}, {42., 0}}, {{44., 
          0.10632163674405926`}, {44., 0}}, {{46., 0.11944558722287224`}, {
          46., 0}}, {{48., 0.133746398167363}, {48., 0}}, {{50., 
          0.14934016109785653`}, {50., 0}}, {{52., 0.1663590634900075}, {
          52., 0}}, {{54., 0.18495374944774456`}, {54., 0}}, {{56., 
          0.20529593972030202`}, {56., 0}}, {{58., 0.22758123439739286`}, {
          58., 0}}, {{60., 0.2520319106723151}, {60., 0}}, {{62., 
          0.2788993189675443}, {62., 0}}, {{64., 0.30846508979510934`}, {
          64., 0}}, {{66., 0.34103963288665473`}, {66., 0}}, {{68., 
          0.37695503684550113`}, {68., 0}}, {{70., 0.4165468765496827}, {
          70., 0}}, {{72., 0.4601144688537776}, {72., 0}}, {{74., 
          0.5078395950563956}, {74., 0}}, {{76., 0.5596256222884434}, {
          76., 0}}, {{78., 0.6147861772227584}, {78., 0}}, {{80., 
          0.67146258790217}, {80., 0}}, {{82., 0.7256273736421468}, {
          82., 0}}, {{84., 0.769872093866326}, {84., 0}}, {{86., 
          0.7944732110203436}, {86., 0}}, {{88., 0.799063646343486}, {
          88., 0}}},
        VertexColors->None]}}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], {}, PointBox[CompressedData["
1:eJw9yXtIk3EUxvEfW4RmkFGJoMW2CuaYYDLa8Lanstw083W3fxqisoiiVNzG
Rkm+XqLSEdmihozC6LJgUZShEDVENFoOXHOSoTDR4SZGoUQrQio8dODh8OEr
bmzWnRIwxvL/7t//f2rj+xnNxQAJzP50yNZxgZwJJnG0mGROcjZYoFHyDDay
CMybO+JqP0/eB8adsQ911ZGlYMMfdNnaQvWG5WBNayfFytPkAvAyQSgv7CAX
AuGtnc3LnWQF2MTmDstsD/kg+NWJAetiH1kFXp9s/zl3m1yE2OWax54GL7kE
BV8vTV0rHiCXQaTMuNvvfkAGJnsd3T9KfeRDqMdCsAx+8mFcjUR7Ldxz8hEw
s2+t/uULcjnSnpi2SKpfkY8iJXt4s1QyTD6GRLk/M658Ta6AZ+f42d/ut2QN
uKyMnP49I2QtLN2r22/tHiVXQuHpSaFqjFwFhcbN3/C/Ix+HaNqVt7ciSK4G
xu2jDeIQ+QQEg05rpXiSXIPpJfuVtpkwmYNCLjUvvolsmOdgizrjdyJR6rX4
lTW1KU30iXotvOmC4kHfZ+o6FOWnf+9qnaOuw/oB10cVYtT1CLQo162Jeep6
7Hc92mbwL1A3QBj7lnOvLU7dAJVwNm5SLVE3QqiVhoL3E9SNWJabd+nPJamb
sCN1feVLX1L9B4RnxDc=
      "]], {}}}, {
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], {
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.2], 
       LineBox[{{{0., 0.}, {0., 0}}},
        VertexColors->None]}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.009166666666666668], AbsoluteThickness[1.6], Opacity[0.2], 
       LineBox[{{{2., 0.0006091729809042379}, {2., 0}}, {{4., 
          0.0024359497401758023`}, {4., 0}}, {{6., 0.00547810463172671}, {
          6., 0}}, {{8., 0.009731931258429638}, {8., 0}}, {{10., 
          0.01519224698779198}, {10., 0}}, {{12., 0.02185239926619431}, {
          12., 0}}, {{14., 0.029704273724003527`}, {14., 0}}, {{16., 
          0.038738304061681106`}, {16., 0}}, {{18., 0.04894348370484647}, {
          18., 0}}, {{20., 0.06030737921409157}, {20., 0}}, {{22., 
          0.07281614543321258}, {22., 0}}, {{24., 0.08645454235739913}, {
          24., 0}}, {{26., 0.10120595370083296`}, {26., 0}}, {{28., 
          0.11705240714107301`}, {28., 0}}, {{30., 0.1339745962155614}, {
          30., 0}}, {{32., 0.15195190384357404`}, {32., 0}}, {{34., 
          0.17096242744495826`}, {34., 0}}, {{36., 0.19098300562505255`}, {
          36., 0}}, {{38., 0.2119892463932781}, {38., 0}}, {{40., 
          0.233955556881022}, {40., 0}}, {{42., 0.25685517452260576`}, {
          42., 0}}, {{44., 0.2806601996613488}, {44., 0}}, {{46., 
          0.30534162954100275`}, {46., 0}}, {{48., 0.33086939364114176`}, {
          48., 0}}, {{50., 0.35721239031346075`}, {50., 0}}, {{52., 
          0.3843385246743417}, {52., 0}}, {{54., 0.41221474770752686`}, {
          54., 0}}, {{56., 0.4408070965292532}, {56., 0}}, {{58., 
          0.4700807357667951}, {58., 0}}, {{60., 0.5}, {60., 0}}, {{62., 
          0.5305284372141092}, {62., 0}}, {{64., 0.5616288532109226}, {
          64., 0}}, {{66., 0.5932633569241998}, {66., 0}}, {{68., 
          0.625393406584088}, {68., 0}}, {{70., 0.6579798566743313}, {
          70., 0}}, {{72., 0.6909830056250525}, {72., 0}}, {{74., 
          0.7243626441830009}, {74., 0}}, {{76., 0.7580781044003323}, {
          76., 0}}, {{78., 0.7920883091822407}, {78., 0}}, {{80., 
          0.8263518223330697}, {80., 0}}, {{82., 0.8608268990399346}, {
          82., 0}}, {{84., 0.8954715367323466}, {84., 0}}, {{86., 
          0.9302435262558747}, {86., 0}}, {{88., 0.9651005032974991}, {
          88., 0}}, {{90., 1.}, {90., 0}}},
        VertexColors->None]}}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], {}, PointBox[CompressedData["
1:eJx1z21IkwEUhuGXVhEFNUxjxSatMoTcCDPJCvdMnVmWzenGKIlVGhWFK0sw
DGwKSdFkELIohvSJEDUSy1mhpaMtHWRixZo1h9WyaSKyxSio2NPPDhwOF/ev
Iz9QrauaIwiC8s/+vf8ZCJUTIlk0X5WgGMJCocU6e5CWQJANNm4019Ir0TDm
79BPNdJrgHjXR6mshU6HMN3jrDO10hkwPfaIB4866PUQiiQvz43coDMhdnYP
pC5pp7MA5aj/avAenQ3cUm9IvvmA3gSjaG5zSP6Q3gxnTkna9bCL3oreF61N
abGndC6MPse+5LXPaCCyxzubXtNHq3FMU+GVhNx0HkyKNpv8pIfOxxOz0lm7
aoAugLTn+Sn1jI/WoN5iv681v6ILYa3qzDREh+htCC5XOR5dGKaLoA1veR3N
GKG3wzN8fq8t8IbeAevxpmvClXd0MQqKU2Ku/X56JwLzAjFldoDehbua2xZf
yge6BIkbpHej/+2ke1n8n7WQ/mpLGv0xlnCDFvaZ+mrRzxB7KXqzLi3IEY2z
l2J+vNu9bvEndh2Miw5XNks/s+sQ6Tpkiyu+sJfBNVQoUuSF2cvQd+T7Za/x
K3s5UlefNdWdmGAvxxl7hX/84jd2PZaetkc67kTY9XjfqUuy9k+yG5BrMdWs
CE2xG/jvtOo3Ui/JBw==
      "]], {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0, 90}, {-0.0066612727435566566`, 0.799063646343486}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.679487687604911*^9, 3.679487711733288*^9}, 
   3.679487759869934*^9, 3.679487922817882*^9, 3.6794880889893045`*^9, 
   3.6794881371112566`*^9, {3.679488207923133*^9, 3.679488250318388*^9}, 
   3.67948834278139*^9, 3.679488418414654*^9, {3.679549519578363*^9, 
   3.679549537815441*^9}, 3.679549635405055*^9, 3.6795496963191686`*^9}]
}, Open  ]]
},
WindowSize->{942, 960},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5606, 142, 517, "Input"],
Cell[6189, 166, 597, 12, 40, "Message"],
Cell[6789, 180, 644, 13, 24, "Message"],
Cell[7436, 195, 9542, 180, 407, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

