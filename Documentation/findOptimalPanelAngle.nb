(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30661,        702]
NotebookOptionsPosition[     29933,        675]
NotebookOutlinePosition[     30274,        690]
CellTagsIndexPosition[     30231,        687]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Find", " ", "optimal", " ", "angle", " ", "by", " ", "date"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"date", " ", "=", " ", 
     RowBox[{"DateObject", "[", 
      RowBox[{"{", 
       RowBox[{"2016", ",", "7", ",", "19"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"h_", ",", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{"(", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Arguments", ":", " ", 
        RowBox[{"hour", " ", "of", " ", "day"}]}], ",", " ", 
       RowBox[{"solar", " ", "panel", " ", "angle"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sunPos", " ", "=", " ", 
       RowBox[{"SunPosition", "[", 
        RowBox[{
         RowBox[{"GeoPosition", "[", 
          RowBox[{"{", 
           RowBox[{"51.546545", ",", "4.411744"}], "}"}], "]"}], ",", 
         RowBox[{"DateObject", "[", 
          RowBox[{"date", ",", 
           RowBox[{"{", "h", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"remove", " ", "degree", " ", "unit"}], ",", " ", 
        RowBox[{"then", " ", "convert", " ", "to", " ", "radians"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[Gamma]", "s"], "=", " ", 
       RowBox[{
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"Quantity", "[", 
          RowBox[{"sunPos", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*", 
        RowBox[{"Pi", "/", "180"}]}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Azimuth", " ", "of", " ", "sun", " ", "position"}], ",", " ", 
        RowBox[{"0", " ", "due", " ", "South"}], ",", " ", 
        RowBox[{"negative", " ", "to", " ", "the", " ", "east"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Because", " ", "Mathematica", " ", "gives", " ", "azimuth", " ", 
         "in", " ", "compass", " ", "angle"}], ",", " ", 
        RowBox[{"we", " ", "subtract", " ", "180", " ", "degrees"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[Gamma]", "s"], " ", "=", " ", 
       RowBox[{
        SubscriptBox["\[Gamma]", "s"], " ", "-", " ", "Pi"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[Theta]", "s"], "=", " ", 
       RowBox[{
        RowBox[{"QuantityMagnitude", "[", 
         RowBox[{"Quantity", "[", 
          RowBox[{"sunPos", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "*", 
        RowBox[{"Pi", "/", "180"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Sun", " ", "altitude"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[Gamma]", "p"], " ", "=", " ", "0"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Solar", " ", "panels", " ", "azimuth"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["\[Theta]", "p"], " ", "=", " ", 
       RowBox[{"x", " ", "*", " ", 
        RowBox[{"Pi", "/", "180"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Solar", " ", "panels", " ", "angle", " ", "with", " ", "horizontal"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", " ", "=", 
       RowBox[{
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Gamma]", "p"], "-", 
             SubscriptBox["\[Gamma]", "s"]}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "p"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            SubscriptBox["\[Theta]", "p"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            SubscriptBox["\[Theta]", "s"], "]"}]}]}], "]"}], "*", 
        RowBox[{"180", "/", "Pi"}]}]}]}], "\[IndentingNewLine]", ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Example", ":", " ", 
     RowBox[{
     "plot", " ", "angle", " ", "to", " ", "sun", " ", "for", " ", "solar", 
      " ", "panels", " ", "at", " ", "30", " ", "degrees"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", ",", "30"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "24", ",", "0.05"}], "}"}]}], "]"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Define", " ", "a", " ", "function", " ", "that", " ", "sums", " ", "up", 
     " ", "the", " ", "total", " ", "of", " ", "angles", " ", "to", " ", 
     "the", " ", "sun"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"position", " ", "=", " ", 
     RowBox[{"GeoPosition", "[", 
      RowBox[{"{", 
       RowBox[{"51.546545", ",", "4.411744"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunUp", " ", "=", " ", 
     RowBox[{"Sunrise", "[", 
      RowBox[{"position", ",", "date"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunUpHour", " ", "=", " ", 
     RowBox[{
      RowBox[{"DateValue", "[", 
       RowBox[{"sunUp", ",", "\"\<Hour\>\""}], "]"}], "+", 
      RowBox[{
       RowBox[{"DateValue", "[", 
        RowBox[{"sunUp", ",", " ", "\"\<Minute\>\""}], "]"}], "/", "60"}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunset", " ", "=", " ", 
     RowBox[{"Sunset", "[", 
      RowBox[{"position", ",", "date"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunsetHour", " ", "=", " ", 
     RowBox[{
      RowBox[{"DateValue", "[", 
       RowBox[{"sunset", ",", "\"\<Hour\>\""}], "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"DateValue", "[", 
        RowBox[{"sunset", ",", " ", "\"\<Minute\>\""}], "]"}], "/", 
       "60"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"g", "[", "a_", "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"h", ",", "a"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "sunUpHour", ",", "sunsetHour"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Find", " ", "for", " ", "which", " ", "angle", " ", "of", " ", "the", 
     " ", "solar", " ", "panels", " ", "this", " ", "value", " ", "is", " ", 
     "minimal"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"g", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "90"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindMinimum", "[", 
     RowBox[{
      RowBox[{"g", "[", "x", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "0", ",", "90"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6777523008229904`*^9, 3.6777523055819473`*^9}, {
   3.6777523786191893`*^9, 3.6777524646509376`*^9}, {3.677752498351569*^9, 
   3.6777525132405577`*^9}, {3.677752657065937*^9, 3.677752661454502*^9}, {
   3.6777527028569903`*^9, 3.677752737672872*^9}, {3.6777527693895817`*^9, 
   3.6777527714981503`*^9}, {3.677752822589284*^9, 3.677752826128205*^9}, {
   3.677752894195289*^9, 3.677752911061884*^9}, {3.6777530337349496`*^9, 
   3.67775312272355*^9}, {3.67775316050369*^9, 3.6777532792577553`*^9}, {
   3.6777533263243885`*^9, 3.677753526777845*^9}, {3.677753578339822*^9, 
   3.6777535849230995`*^9}, {3.677753679322294*^9, 3.677753760338477*^9}, {
   3.6777538255941486`*^9, 3.6777538263569264`*^9}, {3.6777541420730553`*^9, 
   3.677754189060274*^9}, {3.6777542444288225`*^9, 3.677754244974002*^9}, {
   3.6777543558431377`*^9, 3.6777543925623946`*^9}, {3.677754469664623*^9, 
   3.6777546058890038`*^9}, {3.677754827982485*^9, 3.677754926043544*^9}, {
   3.677755005544764*^9, 3.6777550626445327`*^9}, {3.6777550947697554`*^9, 
   3.677755095311152*^9}, {3.6777551883189073`*^9, 3.6777552085036955`*^9}, {
   3.6777552792853374`*^9, 3.677755288881044*^9}, {3.6777553338924265`*^9, 
   3.6777553517498603`*^9}, {3.67775538973627*^9, 3.6777554096261477`*^9}, {
   3.677755577642505*^9, 3.677755617873442*^9}, {3.677755679621212*^9, 
   3.677755722822532*^9}, {3.6777557812285*^9, 3.677755858796904*^9}, {
   3.677755951047785*^9, 3.6777560618205595`*^9}, {3.6777561727584734`*^9, 
   3.677756204338975*^9}, {3.6777562432701035`*^9, 3.6777562506721845`*^9}, {
   3.67775629574061*^9, 3.6777563066539097`*^9}, {3.677756483984335*^9, 
   3.6777564883901596`*^9}, {3.6777565613862886`*^9, 
   3.6777565841986265`*^9}, {3.6777566262058954`*^9, 3.677756700821476*^9}, {
   3.6777569732590656`*^9, 3.6777570535798006`*^9}, {3.6777571671365304`*^9, 
   3.6777573643845296`*^9}, {3.6777574074897857`*^9, 
   3.6777575405443335`*^9}, {3.6777587941279373`*^9, 3.677758800740677*^9}, {
   3.6777588795750966`*^9, 3.6777588861473093`*^9}, {3.6777589284845524`*^9, 
   3.677758959563032*^9}, {3.6777593662187777`*^9, 3.677759442503894*^9}, {
   3.6777595017064776`*^9, 3.677759563307456*^9}, {3.6777599278717365`*^9, 
   3.677759930399372*^9}, {3.6777639725202627`*^9, 3.677763985897771*^9}, {
   3.6777641118531094`*^9, 3.677764125742916*^9}, {3.6777644959500537`*^9, 
   3.6777645194962606`*^9}, {3.6777648652408967`*^9, 3.677764879317292*^9}, {
   3.677765054499483*^9, 3.677765063039106*^9}, {3.6777652122972755`*^9, 
   3.677765246927101*^9}, {3.677765359539589*^9, 3.6777653635063963`*^9}, {
   3.6777653967952127`*^9, 3.677765412598694*^9}, {3.677766219523001*^9, 
   3.677766221026521*^9}, {3.6777662579254093`*^9, 3.677766314524816*^9}, {
   3.677767120909026*^9, 3.677767123599637*^9}, {3.6777673779312773`*^9, 
   3.6777674030811596`*^9}, {3.677767444904043*^9, 3.6777674708850417`*^9}, 
   3.67776751856098*^9, {3.677767584134828*^9, 3.677767584596323*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.677753072579315*^9, 3.6777534981405478`*^9, {3.6777537243380995`*^9, 
   3.6777537606986055`*^9}, 3.6777538268878727`*^9, 3.6777542778294525`*^9, {
   3.677754528684951*^9, 3.6777545346317296`*^9}, 3.6777545839154515`*^9, 
   3.677754837291441*^9, {3.677754901434345*^9, 3.677754935326848*^9}, {
   3.6777550290507207`*^9, 3.6777550556669407`*^9}, 3.677755096011386*^9, {
   3.677755190756535*^9, 3.677755209704876*^9}, {3.6777552802886543`*^9, 
   3.677755289518915*^9}, {3.6777553354912653`*^9, 3.677755352461479*^9}, 
   3.6777554159520655`*^9, {3.6777555970555573`*^9, 3.6777556190149813`*^9}, 
   3.677755682888301*^9, 3.677755735079043*^9, 3.677755801894539*^9, 
   3.677755859675392*^9, 3.6777562523682814`*^9, 3.677756307829989*^9, {
   3.677756564550577*^9, 3.677756584927619*^9}, {3.6777566944414206`*^9, 
   3.677756702078822*^9}, 3.677756997893797*^9, 3.6777570301931095`*^9, 
   3.677757216201995*^9, 3.6777572949093986`*^9, 3.67775745607545*^9, {
   3.677757499630742*^9, 3.67775754175643*^9}, {3.677758800520722*^9, 
   3.6777588035005727`*^9}, 3.6777589604325953`*^9, {3.6777593721354065`*^9, 
   3.6777593941689796`*^9}, 3.677759444973214*^9, {3.6777595381796274`*^9, 
   3.677759563989439*^9}, 3.6777599307015924`*^9, 3.677763987106479*^9, 
   3.6777641268179183`*^9, 3.677764516461367*^9, {3.6777648722326*^9, 
   3.677764880592352*^9}, {3.6777650567879143`*^9, 3.677765064679604*^9}, {
   3.6777652139263973`*^9, 3.6777652189477625`*^9}, {3.677765361668044*^9, 
   3.677765372300351*^9}, {3.677766242603632*^9, 3.6777663192460346`*^9}, 
   3.6777671327972355`*^9, {3.677767380482459*^9, 3.6777674067762957`*^9}, {
   3.6777674480863047`*^9, 3.6777674717289467`*^9}, 3.6777675908474073`*^9, 
   3.6777676372520604`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within the \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindMinimum/lstol\\\", ButtonNote -> \
\\\"FindMinimum::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.677767471776947*^9, 3.6777675912716556`*^9, 
  3.677767638013361*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", "\[Rule]", "18.503144286676918`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.677753072579315*^9, 3.6777534981405478`*^9, {3.6777537243380995`*^9, 
   3.6777537606986055`*^9}, 3.6777538268878727`*^9, 3.6777542778294525`*^9, {
   3.677754528684951*^9, 3.6777545346317296`*^9}, 3.6777545839154515`*^9, 
   3.677754837291441*^9, {3.677754901434345*^9, 3.677754935326848*^9}, {
   3.6777550290507207`*^9, 3.6777550556669407`*^9}, 3.677755096011386*^9, {
   3.677755190756535*^9, 3.677755209704876*^9}, {3.6777552802886543`*^9, 
   3.677755289518915*^9}, {3.6777553354912653`*^9, 3.677755352461479*^9}, 
   3.6777554159520655`*^9, {3.6777555970555573`*^9, 3.6777556190149813`*^9}, 
   3.677755682888301*^9, 3.677755735079043*^9, 3.677755801894539*^9, 
   3.677755859675392*^9, 3.6777562523682814`*^9, 3.677756307829989*^9, {
   3.677756564550577*^9, 3.677756584927619*^9}, {3.6777566944414206`*^9, 
   3.677756702078822*^9}, 3.677756997893797*^9, 3.6777570301931095`*^9, 
   3.677757216201995*^9, 3.6777572949093986`*^9, 3.67775745607545*^9, {
   3.677757499630742*^9, 3.67775754175643*^9}, {3.677758800520722*^9, 
   3.6777588035005727`*^9}, 3.6777589604325953`*^9, {3.6777593721354065`*^9, 
   3.6777593941689796`*^9}, 3.677759444973214*^9, {3.6777595381796274`*^9, 
   3.677759563989439*^9}, 3.6777599307015924`*^9, 3.677763987106479*^9, 
   3.6777641268179183`*^9, 3.677764516461367*^9, {3.6777648722326*^9, 
   3.677764880592352*^9}, {3.6777650567879143`*^9, 3.677765064679604*^9}, {
   3.6777652139263973`*^9, 3.6777652189477625`*^9}, {3.677765361668044*^9, 
   3.677765372300351*^9}, {3.677766242603632*^9, 3.6777663192460346`*^9}, 
   3.6777671327972355`*^9, {3.677767380482459*^9, 3.6777674067762957`*^9}, {
   3.6777674480863047`*^9, 3.6777674717289467`*^9}, 3.6777675908474073`*^9, 
   3.677767638029016*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"h_", ",", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Arguments", ":", " ", 
       RowBox[{"hour", " ", "of", " ", "day"}]}], ",", " ", 
      RowBox[{"solar", " ", "panel", " ", "angle"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sunPos", " ", "=", " ", 
      RowBox[{"SunPosition", "[", 
       RowBox[{
        RowBox[{"GeoPosition", "[", 
         RowBox[{"{", 
          RowBox[{"51.546545", ",", "4.411744"}], "}"}], "]"}], ",", 
        RowBox[{"DateObject", "[", 
         RowBox[{"date", ",", 
          RowBox[{"{", "h", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"remove", " ", "degree", " ", "unit"}], ",", " ", 
       RowBox[{"then", " ", "convert", " ", "to", " ", "radians"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Gamma]", "s"], "=", " ", 
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"Quantity", "[", 
         RowBox[{"sunPos", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180"}]}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Azimuth", " ", "of", " ", "sun", " ", "position"}], ",", " ", 
       RowBox[{"0", " ", "due", " ", "South"}], ",", " ", 
       RowBox[{"negative", " ", "to", " ", "the", " ", "east"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Because", " ", "Mathematica", " ", "gives", " ", "azimuth", " ", "in",
         " ", "compass", " ", "angle"}], ",", " ", 
       RowBox[{"we", " ", "subtract", " ", "180", " ", "degrees"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Gamma]", "s"], " ", "=", " ", 
      RowBox[{
       SubscriptBox["\[Gamma]", "s"], " ", "-", " ", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Theta]", "s"], "=", " ", 
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"Quantity", "[", 
         RowBox[{"sunPos", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Sun", " ", "altitude"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Gamma]", "p"], " ", "=", " ", "0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Solar", " ", "panels", " ", "azimuth"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Theta]", "p"], " ", "=", " ", 
      RowBox[{"x", " ", "*", " ", 
       RowBox[{"Pi", "/", "180"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Solar", " ", "panels", " ", "angle", " ", "with", " ", "horizontal"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", " ", "=", 
      RowBox[{
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Gamma]", "p"], "-", 
            SubscriptBox["\[Gamma]", "s"]}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "p"], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           SubscriptBox["\[Theta]", "p"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["\[Theta]", "s"], "]"}]}]}], "]"}], "*", 
       RowBox[{"180", "/", "Pi"}]}]}]}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"month", "[", "d_", "]"}], " ", ":=", " ", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"date", " ", "=", " ", 
     RowBox[{"DateObject", "[", 
      RowBox[{"{", 
       RowBox[{"2016", ",", "7", ",", "d"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Define", " ", "a", " ", "function", " ", "that", " ", "sums", " ", "up",
       " ", "the", " ", "total", " ", "of", " ", "angles", " ", "to", " ", 
      "the", " ", "sun"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"position", " ", "=", " ", 
     RowBox[{"GeoPosition", "[", 
      RowBox[{"{", 
       RowBox[{"51.546545", ",", "4.411744"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sunUp", " ", "=", " ", 
     RowBox[{"Sunrise", "[", 
      RowBox[{"position", ",", "date"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sunUpHour", " ", "=", " ", 
     RowBox[{
      RowBox[{"DateValue", "[", 
       RowBox[{"sunUp", ",", "\"\<Hour\>\""}], "]"}], "+", 
      RowBox[{
       RowBox[{"DateValue", "[", 
        RowBox[{"sunUp", ",", " ", "\"\<Minute\>\""}], "]"}], "/", "60"}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"sunset", " ", "=", " ", 
     RowBox[{"Sunset", "[", 
      RowBox[{"position", ",", "date"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sunsetHour", " ", "=", " ", 
     RowBox[{
      RowBox[{"DateValue", "[", 
       RowBox[{"sunset", ",", "\"\<Hour\>\""}], "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"DateValue", "[", 
        RowBox[{"sunset", ",", " ", "\"\<Minute\>\""}], "]"}], "/", 
       "60"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", "[", "x_", "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"h", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "sunUpHour", ",", "sunsetHour"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Find", " ", "for", " ", "which", " ", "angle", " ", "of", " ", "the", 
      " ", "solar", " ", "panels", " ", "this", " ", "value", " ", "is", " ", 
      "minimal"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"x", " ", "/.", " ", 
     RowBox[{
      RowBox[{"FindMinimum", "[", 
       RowBox[{
        RowBox[{"g", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "0", ",", "90"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"month", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DiscretePlot", "[", 
  RowBox[{
   RowBox[{"month", "[", "a", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "1", ",", "31"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.677765426113825*^9, {3.6777654640895224`*^9, 3.6777654644213104`*^9}, {
   3.6777655912966957`*^9, 3.6777656507955527`*^9}, {3.6777659940076513`*^9, 
   3.677765994423256*^9}, {3.6777662249884233`*^9, 3.6777662255294104`*^9}, {
   3.6777663011232257`*^9, 3.677766326168991*^9}, {3.6777666431207447`*^9, 
   3.6777666640838447`*^9}, {3.6777667973426847`*^9, 
   3.6777668403523855`*^9}, {3.677766881352936*^9, 3.677766918223665*^9}, {
   3.677766959334345*^9, 3.677767012900202*^9}, {3.6777671404166036`*^9, 
   3.677767181903263*^9}, {3.6777672829659257`*^9, 3.677767289938344*^9}}],

Cell[BoxData["14.865771021331657`"], "Output",
 CellChangeTimes->{
  3.6777657245586205`*^9, 3.6777660096469975`*^9, 3.677766241739362*^9, 
   3.6777663179481106`*^9, 3.677766683901058*^9, {3.677766805802096*^9, 
   3.677766818651986*^9}, {3.6777669062245235`*^9, 3.677766918912342*^9}, 
   3.6777669853744144`*^9, 3.677767015380042*^9, {3.6777671441763372`*^9, 
   3.6777671680322914`*^9}, {3.677767286000967*^9, 3.677767290865416*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within the \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindMinimum/lstol\\\", ButtonNote -> \
\\\"FindMinimum::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6777673025851145`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within the \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindMinimum/lstol\\\", ButtonNote -> \
\\\"FindMinimum::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.677767303271648*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within the \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindMinimum/lstol\\\", ButtonNote -> \
\\\"FindMinimum::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6777673064245443`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"FindMinimum\\\", \\\"::\\\", \
\\\"lstol\\\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6777673064469333`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`], 
    AbsoluteThickness[1.6], {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6], Opacity[0.2], 
      LineBox[{{{1., 14.865771021331657`}, {1., 14.865771021331657`}}},
       VertexColors->None]}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6], Opacity[0.2], 
      LineBox[CompressedData["
1:eJxVyU0ogwEcx/GHOchBk9VWZl5CGp49z16eZ/P6l7ckDtZEHJbmtZg4MUnM
y0E5KAflQkwJMXm/cEGklIPXg3cuDDl4jcP2r/+vfodP36hKe3GVhGEY1f/9
vfcOgu/n8hvfksDn4uvzktx1nwPhdjj7+knPommXgtZzZO5zsGjaZeCcLJAb
t1k07QqIzXlc81No0LQrwXEWu3nToEHTHgnqhxX75Y4GTXs0hNtGTxwyDk17
DEgUNV2heRya9jhgB5U6sZ1D0x4P+4vLSXduDk27GsJm3U0RTxya9kRY+HUu
Xqp5NO0snC4w5Qn1PJp2DnqkL7bPaR5NOw9TIe0jXx4eTbsWZjJ1Fy5Ri6Zd
B5Zmq/SgU4umXQ8tW88bQ/UGNO0GyJrfLexeMqBpF+BnjFntCBDQtIuw4s5M
6bcIaNqNUD3e2xfgEtC0m+C47L214lNA054MH+a9q9ciEU17Cnx7Srm6CRFN
eyoMsBfuty8RTXsarFkPQ+osRjTt6SCVd6hVs0Y07RmQl1vbNhpkQvv6HzOj
91I=
       "],
       VertexColors->None]}}}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011000000000000001`], 
    AbsoluteThickness[1.6], {}, PointBox[CompressedData["
1:eJxTTMoPSmViYGCQB2IQDQEf7IMe3wlz263rABVw4Hu+3jPvM4zP4fB0msvj
dyZ6UL6Ag9GHK8Ht1TC+iEPLMm9xi+MwvoSDquvLXYwS+lC+jEP1bdWDT3Jh
fAUHrRc78h+egPGVHGRT5t6sFjGA8lUcmCXSm4TdYXw1B71+GWPzGhhfw+HM
lu26zzbD+FoO0us2F8i/g/F1HDb9a9nyUMsQytdzuLWJIVo7C8Y3cGgV+Jjy
azWMb+iwQrBm1u8PML6Rw1pH47vLzY2gfGOH0KIEgXMNML6JQ/Gh93smZ5lC
+aYOzhtP+jZvg/HNHP4uYthZx2IG5Zs77NjsaN0RCuNbOKQtbmtnWQ7jWzrc
iPxaGfMLxrdy+Bl8+tEnP3Mo39rhz4cIg8ylML6NQ4/e3c2ff8P4tg67Ei4K
ZoZaQPl2DgLidVpy62B8ewd3t4yquVyWDgBYd3zO
     "]], {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{1, 14.865771021331657`},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{1, 31}, {14.865771021331657`, 25.04146542592778}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6777657245586205`*^9, 3.6777660096469975`*^9, 3.677766241739362*^9, 
   3.6777663179481106`*^9, 3.677766683901058*^9, {3.677766805802096*^9, 
   3.677766818651986*^9}, {3.6777669062245235`*^9, 3.677766918912342*^9}, 
   3.6777669853744144`*^9, 3.677767015380042*^9, {3.6777671441763372`*^9, 
   3.6777671680322914`*^9}, {3.677767286000967*^9, 3.6777673091544333`*^9}}]
}, Open  ]]
},
WindowSize->{942, 960},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 10131, 227, 552, "Input"],
Cell[10714, 251, 1798, 25, 31, "Output"],
Cell[12515, 278, 765, 14, 56, "Message"],
Cell[13283, 294, 1858, 27, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15178, 326, 7149, 175, 552, "Input"],
Cell[22330, 503, 437, 6, 31, "Output"],
Cell[22770, 511, 718, 13, 56, "Message"],
Cell[23491, 526, 716, 13, 56, "Message"],
Cell[24210, 541, 718, 13, 56, "Message"],
Cell[24931, 556, 569, 12, 21, "Message"],
Cell[25503, 570, 4414, 102, 245, "Output"]
}, Open  ]]
}
]
*)

